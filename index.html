<!doctype html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rectina Pro Dƒõti ‚Äî Lekce 1</title>
  <style>
    :root {
      --bg: #f6f7fb;
      --ink: #1d1b2d;
      --sun: #ffd447;
      --mint: #6fe0c2;
      --sky: #7bb4ff;
      --coral: #ff7d8c;
      --violet: #635bff;
      --card: #ffffff;
      --shadow: 0 10px 35px rgba(0, 0, 0, 0.08);
      --radius: 18px;
      font-family: "Baloo 2", "Fredoka", "Nunito", "Segoe UI", sans-serif;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      background: radial-gradient(circle at 20% 20%, rgba(255, 212, 71, 0.25), transparent 30%),
                  radial-gradient(circle at 80% 10%, rgba(255, 125, 140, 0.2), transparent 28%),
                  radial-gradient(circle at 10% 80%, rgba(99, 91, 255, 0.18), transparent 25%),
                  var(--bg);
      color: var(--ink);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    .page {
      max-width: 1120px;
      margin: 0 auto;
      padding: 20px 16px 80px;
    }

    header.topbar {
      display: flex;
      align-items: center;
      gap: 16px;
      justify-content: space-between;
      padding: 14px 16px;
      background: rgba(255, 255, 255, 0.78);
      border: 1px solid rgba(99, 91, 255, 0.08);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 12px;
      z-index: 10;
    }

    .brand {
      font-weight: 800;
      letter-spacing: 0.5px;
      font-size: 1.1rem;
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }

    .brand-badge {
      width: 34px;
      height: 34px;
      border-radius: 12px;
      background: linear-gradient(145deg, var(--sun), var(--coral));
      display: grid;
      place-items: center;
      color: #1d1b2d;
      font-weight: 900;
      box-shadow: inset 0 2px 6px rgba(255, 255, 255, 0.6), 0 6px 16px rgba(0, 0, 0, 0.08);
    }

    nav { display: flex; gap: 10px; flex-wrap: wrap; }

    nav a {
      text-decoration: none;
      color: var(--ink);
      font-weight: 700;
      padding: 8px 12px;
      border-radius: 12px;
      transition: background 180ms ease, transform 180ms ease;
    }

    nav a:hover, nav a:focus-visible {
      background: rgba(123, 180, 255, 0.18);
      outline: none;
      transform: translateY(-1px);
    }

    .nav-label {
      font-weight: 800;
      padding: 8px 0;
      display: inline-flex;
      align-items: center;
    }

    .top-actions { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }

    button {
      border: none;
      cursor: pointer;
      font-weight: 700;
      border-radius: 12px;
      transition: transform 140ms ease, box-shadow 140ms ease, background 140ms ease;
    }

    button:focus-visible {
      outline: 3px solid rgba(99, 91, 255, 0.35);
      outline-offset: 2px;
    }

    .pill {
      padding: 9px 14px;
      background: var(--card);
      border: 1px solid rgba(99, 91, 255, 0.12);
      box-shadow: var(--shadow);
    }

    .section {
      margin: 26px 0;
      background: rgba(255, 255, 255, 0.92);
      border-radius: calc(var(--radius) * 1.05);
      padding: 22px 20px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(123, 180, 255, 0.08);
    }

    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    .section-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1.2rem;
      font-weight: 800;
    }

    .tag {
      background: rgba(99, 91, 255, 0.12);
      padding: 6px 10px;
      border-radius: 10px;
      font-weight: 700;
      color: #2b2753;
      font-size: 0.9rem;
    }

    .tile-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
      gap: 12px;
    }

    .word-grid { grid-template-columns: repeat(6, minmax(0, 1fr)); }

    @media (max-width: 900px) {
      .word-grid { grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); }
    }

    .tile {
      background: var(--card);
      border-radius: var(--radius);
      padding: 16px;
      display: grid;
      gap: 8px;
      align-items: start;
      min-height: 130px;
      border: 1px solid rgba(99, 91, 255, 0.08);
      box-shadow: var(--shadow);
      text-align: left;
      width: 100%;
    }

    .tile strong { font-size: 1.05rem; }
    .tile small { color: #4d4a5f; font-weight: 600; }
    .tile .mini { font-size: 0.9rem; color: #2b2753; font-weight: 600; }

    .avatar {
      width: 38px;
      height: 38px;
      border-radius: 14px;
      display: grid;
      place-items: center;
      font-weight: 800;
      color: #0f2233;
      box-shadow: inset 0 2px 8px rgba(255, 255, 255, 0.5), var(--shadow);
    }

    .word-avatar {
      width: 56px;
      height: 56px;
      border-radius: 18px;
      font-size: 2rem;
    }

    .flash-grid {
      display: grid;
      grid-template-columns: repeat(6, minmax(0, 1fr));
      gap: 14px;
    }

    @media (max-width: 900px) {
      .flash-grid {
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      }
    }

    .flash-card {
      perspective: 800px;
      height: 230px;
      position: relative;
    }

    .flash-inner {
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid rgba(99, 91, 255, 0.08);
      overflow: hidden;
      background: var(--card);
    }

    .flash-face {
      position: absolute;
      inset: 0;
      border-radius: var(--radius);
      padding: 16px;
      display: grid;
      gap: 8px;
      background: var(--card);
      grid-template-rows: auto 1fr auto;
      opacity: 1;
      transition: opacity 180ms ease;
    }

    .flash-illo {
      width: 52px;
      height: 52px;
      border-radius: 16px;
      background: rgba(99, 91, 255, 0.08);
      display: grid;
      place-items: center;
      font-size: 1.8rem;
      justify-self: end;
      box-shadow: inset 0 2px 8px rgba(255, 255, 255, 0.4);
    }

    .flash-back {
      background: linear-gradient(145deg, rgba(111, 224, 194, 0.2), rgba(255, 255, 255, 0.95));
      opacity: 0;
      pointer-events: none;
    }

    .flash-inner[data-flipped="true"] .flash-front { opacity: 0; pointer-events: none; }
    .flash-inner[data-flipped="true"] .flash-back { opacity: 1; pointer-events: auto; }

    .phrase-list, .gesture-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px;
    }

    .phrase-row, .gesture-row {
      display: flex;
      gap: 10px;
      align-items: center;
      padding: 12px;
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid rgba(99, 91, 255, 0.08);
    }

    .phrase-row button,
    .gesture-row button {
      padding: 8px 12px;
      background: rgba(99, 91, 255, 0.08);
      border: 1px solid rgba(99, 91, 255, 0.14);
      box-shadow: var(--shadow);
    }

    .video-card {
      display: grid;
      grid-template-columns: 1fr;
      gap: 14px;
      background: linear-gradient(160deg, rgba(123, 180, 255, 0.22), rgba(255, 255, 255, 0.95));
      padding: 16px;
      border-radius: var(--radius);
      border: 1px solid rgba(99, 91, 255, 0.12);
      box-shadow: var(--shadow);
      text-align: left;
    }

    .video-box {
      background: #0f2233;
      color: #fff;
      border-radius: 14px;
      min-height: 160px;
      display: grid;
      place-items: center;
      position: relative;
      overflow: hidden;
    }

    .video-box::after {
      content: "‚ñ∂";
      font-size: 2.8rem;
      color: #fff;
      opacity: 0.86;
    }

    .memory-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
    }

    .memory-card {
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid rgba(99, 91, 255, 0.12);
      min-height: 100px;
      display: grid;
      place-items: center;
      font-weight: 800;
      font-size: 1rem;
      box-shadow: var(--shadow);
      position: relative;
    }

    .memory-card[data-state="hidden"] { background: linear-gradient(135deg, var(--sun), var(--mint)); color: #0f2233; }
    .memory-card[data-state="open"] { background: #fffef5; border-color: rgba(255, 212, 71, 0.8); }
    .memory-card[data-state="matched"] { background: rgba(111, 224, 194, 0.25); color: #0f4b3e; }

    footer { margin-top: 30px; text-align: center; color: #4a4761; font-weight: 600; }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after { animation: none !important; transition: none !important; }
    }
  </style>
</head>
<body>
  <div class="page">
    <header class="topbar">
      <div class="brand">
        <div class="brand-badge">R1</div>
        Lekce 1 ‚Äî Barvy, pozdravy, pexeso
      </div>
      <nav aria-label="Hlavn√≠ navigace">
        <span class="nav-label">Lekce 1</span>
        <button class="pill" id="pickLesson">Vybrat lekci</button>
      </nav>
      <div class="top-actions"></div>
    </header>

    <main id="zacatek">
      <section class="section" id="slova">
        <div class="section-header">
          <div class="section-title">
            <span class="tag">Zn√°me slova</span>
            Zaƒçneme s barvami a pozdravy
          </div>
          <span class="tag" style="background: rgba(255, 212, 71, 0.25);">Lekce 1</span>
        </div>
        <div class="tile-grid word-grid" id="wordGrid"></div>
      </section>

      <section class="section" id="karty">
        <div class="section-header">
          <div class="section-title">
            <span class="tag" style="background: rgba(99, 91, 255, 0.15);">Flashcards</span>
            Obrac√≠me ƒçesky ‚Üî ≈ôecky
          </div>
          <button class="pill" id="shuffleFlash">Zam√≠chat karty</button>
        </div>
        <div class="flash-grid" id="flashGrid"></div>
      </section>

      <section class="section" id="gesta">
        <div class="section-header">
          <div class="section-title">
            <span class="tag" style="background: rgba(111, 224, 194, 0.25); color:#0f4b3e;">P≈ô√≠kazy</span>
            Jednoduch√© povely
          </div>
        </div>
        <div class="gesture-list" id="gestureList"></div>
      </section>

      <section class="section" id="fraze">
        <div class="section-header">
          <div class="section-title">
            <span class="tag" style="background: rgba(255, 125, 140, 0.16); color:#742436;">Slovn√≠ spojen√≠</span>
            Kr√°tk√© fr√°ze ke ƒçten√≠
          </div>
        </div>
        <div class="phrase-list" id="phraseList"></div>
      </section>

      <section class="section" id="video">
        <div class="section-header">
          <div class="section-title">
            <span class="tag" style="background: rgba(123, 180, 255, 0.22);">Uk√°zkov√© video</span>
            Kr√°tk√Ω klip k lekci
          </div>
        </div>
        <div class="video-card">
          <div class="video-box" id="videoBox" role="button" aria-label="P≈ôehr√°t uk√°zkov√© video"></div>
          <div>
            <strong>‚ÄûSlunce a modr√© mo≈ôe‚Äú</strong>
            <p>Mini klip, kde dƒõti pozdrav√≠ ‚ÄûAhoj / Kalim√©ra‚Äú, uk√°≈æou na slunce a mo≈ôe a ≈ôeknou kr√°tkou vƒõtu.</p>
          </div>
        </div>
      </section>

      <section class="section" id="pexeso">
        <div class="section-header">
          <div class="section-title">
            <span class="tag" style="background: rgba(99, 91, 255, 0.15);">Pexeso</span>
            Najdi dvojice CZ ‚Üî GR
          </div>
          <div class="top-actions">
            <button class="pill" id="resetPexeso">Nov√° hra</button>
            <span id="pexesoStatus" class="tag">0/6 nalezeno</span>
          </div>
        </div>
        <div class="memory-grid" id="memoryGrid" aria-live="polite"></div>
      </section>
    </main>

    <footer>
      Lekce 1 je p≈ôipraven√°. P≈ôid√°me audio, ilustrace a dal≈°√≠ hry.
    </footer>
  </div>

  <script>
    const state = {
      muted: false,
      pexesoOpen: [],
      pexesoMatched: new Set()
    };

    let audioCtx;
    const toneQueue = [];

    function ensureAudio() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
    }

    function playTone(frequency = 600, duration = 0.25) {
      if (state.muted) return;
      ensureAudio();
      const now = audioCtx.currentTime;
      const startAt = toneQueue.length ? toneQueue[toneQueue.length - 1] + 0.05 : now;
      const endAt = startAt + duration;
      toneQueue.push(endAt);

      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.type = "sine";
      osc.frequency.value = frequency;
      gain.gain.setValueAtTime(0.12, startAt);
      gain.gain.exponentialRampToValueAtTime(0.0001, endAt);
      osc.connect(gain).connect(audioCtx.destination);
      osc.start(startAt);
      osc.stop(endAt);
      setTimeout(() => toneQueue.shift(), duration * 1000 + 80);
    }

    const words = [
      { cz: "Slunce", gr: "ŒâŒªŒπŒøœÇ", color: "var(--sun)", icon: "‚òÄÔ∏è" },
      { cz: "Mo≈ôe", gr: "ŒòŒ¨ŒªŒ±œÉœÉŒ±", color: "var(--sky)", icon: "üåä" },
      { cz: "Ahoj", gr: "ŒìŒµŒπŒ± œÉŒøœÖ", color: "var(--mint)", icon: "üëã" },
      { cz: "Pros√≠m", gr: "Œ†Œ±œÅŒ±Œ∫Œ±Œªœé", color: "var(--coral)", icon: "üòä" },
      { cz: "Dƒõkuji", gr: "ŒïœÖœáŒ±œÅŒπœÉœÑœé", color: "var(--violet)", icon: "üôè" },
      { cz: "Ruka", gr: "ŒßŒ≠œÅŒπ", color: "var(--sky)", icon: "‚úã" }
    ];

    const flashcards = [
      { front: "≈Ωlut√°", back: "ŒöŒØœÑœÅŒπŒΩŒø", example: "Slunce je ≈ælut√©.", exampleGr: "Œü ŒÆŒªŒπŒøœÇ ŒµŒØŒΩŒ±Œπ Œ∫ŒØœÑœÅŒπŒΩŒøœÇ.", icon: "‚òÄÔ∏è" },
      { front: "Modr√°", back: "ŒúœÄŒªŒµ", example: "Mo≈ôe je modr√©.", exampleGr: "Œó Œ∏Œ¨ŒªŒ±œÉœÉŒ± ŒµŒØŒΩŒ±Œπ ŒºœÄŒªŒµ.", icon: "üåä" },
      { front: "Zelen√°", back: "Œ†œÅŒ¨œÉŒπŒΩŒø", example: "List je zelen√Ω.", exampleGr: "Œ§Œø œÜœçŒªŒªŒø ŒµŒØŒΩŒ±Œπ œÄœÅŒ¨œÉŒπŒΩŒø.", icon: "üåø" },
      { front: "Ahoj!", back: "ŒìŒµŒπŒ±!", example: "≈òekni: \"Ahoj, kamar√°de!\"", exampleGr: "Œ†ŒµœÇ: \"ŒìŒµŒπŒ±, œÜŒØŒªŒµ!\"", icon: "üëã" },
      { front: "Dƒõkuji", back: "ŒïœÖœáŒ±œÅŒπœÉœÑœé", example: "≈òekni: \"Dƒõkuji!\"", exampleGr: "Œ†ŒµœÇ: \"ŒïœÖœáŒ±œÅŒπœÉœÑœé!\"", icon: "üôè" },
      { front: "Pros√≠m", back: "Œ†Œ±œÅŒ±Œ∫Œ±Œªœé", example: "≈òekni: \"Pros√≠m, m≈Ø≈æe≈°?\"", exampleGr: "Œ†ŒµœÇ: \"Œ†Œ±œÅŒ±Œ∫Œ±Œªœé, ŒºœÄŒøœÅŒµŒØœÇ;\"", icon: "üòä" }
    ];

    const gestures = [
      { label: "Vsta≈à!", desc: "Postav se hned.", descGr: "Œ£ŒÆŒ∫œâ œÑœéœÅŒ±.", tone: 660 },
      { label: "Sedni!", desc: "Posaƒè se dol≈Ø.", descGr: "ŒöŒ¨œÑœÉŒµ Œ∫Œ¨œÑœâ.", tone: 520 },
      { label: "Otoƒç se!", desc: "Udƒõlaj malou otoƒçku.", descGr: "ŒöŒ¨ŒΩŒµ ŒºŒπŒ± ŒºŒπŒ∫œÅŒÆ œÉœÑœÅŒøœÜŒÆ.", tone: 740 },
      { label: "≈òekni ahoj!", desc: "≈òekni nahlas \"Ahoj\".", descGr: "Œ†ŒµœÇ Œ¥œÖŒΩŒ±œÑŒ¨ ¬´ŒìŒµŒπŒ±¬ª.", tone: 600 }
    ];

    const phrases = [
      { cz: "Ahoj, j√° jsem Luna.", gr: "ŒìŒµŒπŒ±, ŒµŒØŒºŒ±Œπ Œ∑ ŒõŒøœçŒΩŒ±.", tone: 430 },
      { cz: "Pod√≠vej, modr√° vlna!", gr: "ŒöŒøŒØœÑŒ±, ŒºœÄŒªŒµ Œ∫œçŒºŒ±!", tone: 710 },
      { cz: "Dƒõkuji za hru.", gr: "ŒïœÖœáŒ±œÅŒπœÉœÑœé Œ≥ŒπŒ± œÑŒø œÄŒ±ŒπœáŒΩŒØŒ¥Œπ.", tone: 520 },
      { cz: "Chci hr√°t pexeso.", gr: "ŒòŒ≠Œªœâ ŒΩŒ± œÄŒ±ŒØŒæœâ ŒºŒΩŒÆŒºŒ∑.", tone: 640 }
    ];

    const pexesoCards = [
      { id: "sun", label: "Slunce", lang: "CZ" },
      { id: "sun", label: "ŒâŒªŒπŒøœÇ", lang: "GR" },
      { id: "sea", label: "Mo≈ôe", lang: "CZ" },
      { id: "sea", label: "ŒòŒ¨ŒªŒ±œÉœÉŒ±", lang: "GR" },
      { id: "hi", label: "Ahoj", lang: "CZ" },
      { id: "hi", label: "ŒìŒµŒπŒ±", lang: "GR" },
      { id: "blue", label: "Modr√°", lang: "CZ" },
      { id: "blue", label: "ŒúœÄŒªŒµ", lang: "GR" },
      { id: "yellow", label: "≈Ωlut√°", lang: "CZ" },
      { id: "yellow", label: "ŒöŒØœÑœÅŒπŒΩŒø", lang: "GR" },
      { id: "thanks", label: "Dƒõkuji", lang: "CZ" },
      { id: "thanks", label: "ŒïœÖœáŒ±œÅŒπœÉœÑœé", lang: "GR" }
    ];

    function renderWords() {
      const grid = document.getElementById("wordGrid");
      grid.innerHTML = "";
      words.forEach((w) => {
        const btn = document.createElement("button");
        btn.className = "tile";
        btn.style.borderColor = w.color;
        btn.style.background = `radial-gradient(circle at 20% 20%, ${w.color}22, var(--card))`;
        btn.innerHTML = `
          <div class="avatar word-avatar" style="background:${w.color}33;">${w.icon || ""}</div>
          <strong>${w.cz}</strong>
          <small>${w.gr}</small>
          <span class="mini"></span>
        `;
        btn.addEventListener("click", () => playTone(620, 0.18));
        grid.appendChild(btn);
      });
    }

    function renderFlashcards(data) {
      const grid = document.getElementById("flashGrid");
      grid.innerHTML = "";
      data.forEach((card) => {
        const wrap = document.createElement("div");
        wrap.className = "flash-card";

        const inner = document.createElement("div");
        inner.className = "flash-inner";

        inner.innerHTML = `
          <div class="flash-face flash-front">
            <div class="flash-illo" aria-hidden="true">${card.icon || "‚òÖ"}</div>
            <div class="avatar" style="background: rgba(123, 180, 255, 0.18);">CZ</div>
            <strong>${card.front}</strong>
            <small>${card.example}</small>
            <button class="pill">Otoƒçit</button>
          </div>
          <div class="flash-face flash-back">
            <div class="flash-illo" aria-hidden="true">${card.icon || "‚òÖ"}</div>
            <div class="avatar" style="background: rgba(255, 125, 140, 0.2);">GR</div>
            <strong>${card.back}</strong>
            <small>${card.exampleGr || card.example}</small>
            <button class="pill">Zpƒõt</button>
          </div>
        `;
        wrap.addEventListener("click", () => {
          const flipped = inner.dataset.flipped === "true";
          inner.dataset.flipped = (!flipped).toString();
          playTone(flipped ? 540 : 720, 0.16);
        });
        wrap.appendChild(inner);
        grid.appendChild(wrap);
      });
    }

    function renderGestures() {
      const list = document.getElementById("gestureList");
      list.innerHTML = "";
      gestures.forEach((g) => {
        const row = document.createElement("div");
        row.className = "gesture-row";
        row.innerHTML = `
          <div class="avatar" style="background: rgba(111, 224, 194, 0.25);">‚úã</div>
          <div style="flex:1;">
            <strong>${g.label}</strong><br>
            <small>${g.desc}</small><br>
            <small>${g.descGr || ""}</small>
          </div>
          <button class="pill" data-tone="${g.tone}">Zkusit</button>
        `;
        row.querySelector("button").addEventListener("click", () => playTone(g.tone, 0.18));
        list.appendChild(row);
      });
    }

    function renderPhrases() {
      const list = document.getElementById("phraseList");
      list.innerHTML = "";
      phrases.forEach((p) => {
        const row = document.createElement("div");
        row.className = "phrase-row";
        row.innerHTML = `
          <div class="avatar" style="background: rgba(255, 125, 140, 0.2);">üó£</div>
          <div style="flex:1;">
            <strong>${p.cz}</strong><br>
            <small>${p.gr}</small>
          </div>
          <button class="pill" data-tone="${p.tone}">P≈ôehr√°t</button>
        `;
        row.querySelector("button").addEventListener("click", () => playTone(p.tone, 0.2));
        list.appendChild(row);
      });
    }

    function renderPexeso() {
      const grid = document.getElementById("memoryGrid");
      grid.innerHTML = "";
      state.pexesoOpen = [];
      state.pexesoMatched = new Set();

      const shuffled = [...pexesoCards].sort(() => Math.random() - 0.5);
      shuffled.forEach((card, idx) => {
        const btn = document.createElement("button");
        btn.className = "memory-card";
        btn.dataset.id = card.id;
        btn.dataset.index = idx;
        btn.dataset.state = "hidden";
        btn.innerHTML = `<span style="opacity:0;">?</span>`;
        btn.addEventListener("click", () => handlePexesoClick(btn, card));
        grid.appendChild(btn);
      });
      updatePexesoStatus();
    }

    function handlePexesoClick(btn, card) {
      const currentState = btn.dataset.state;
      if (currentState === "matched" || currentState === "open") return;
      if (state.pexesoOpen.length === 2) return;

      btn.dataset.state = "open";
      btn.textContent = card.label;
      playTone(620, 0.16);
      state.pexesoOpen.push({ btn, card });

      if (state.pexesoOpen.length === 2) {
        const [first, second] = state.pexesoOpen;
        const isMatch = first.card.id === second.card.id && first.btn !== second.btn;
        setTimeout(() => {
          if (isMatch) {
            first.btn.dataset.state = "matched";
            second.btn.dataset.state = "matched";
            state.pexesoMatched.add(first.card.id);
            playTone(820, 0.18);
          } else {
            first.btn.dataset.state = "hidden";
            first.btn.textContent = "?";
            second.btn.dataset.state = "hidden";
            second.btn.textContent = "?";
            playTone(360, 0.14);
          }
          state.pexesoOpen = [];
          updatePexesoStatus();
        }, 650);
      }
    }

    function updatePexesoStatus() {
      const status = document.getElementById("pexesoStatus");
      status.textContent = `${state.pexesoMatched.size}/${pexesoCards.length / 2} nalezeno`;
      status.dataset.active = (state.pexesoMatched.size === pexesoCards.length / 2).toString();
    }

    function bindControls() {
      const shuffleFlash = document.getElementById("shuffleFlash");
      const videoBox = document.getElementById("videoBox");
      const resetPexeso = document.getElementById("resetPexeso");
      const pickLesson = document.getElementById("pickLesson");

      shuffleFlash.addEventListener("click", () => {
        renderFlashcards([...flashcards].sort(() => Math.random() - 0.5));
        playTone(780, 0.16);
      });

      videoBox.addEventListener("click", () => {
        videoBox.textContent = "Hraje uk√°zka...";
        playTone(520, 0.3);
        setTimeout(() => {
          videoBox.textContent = "";
        }, 1200);
      });

      resetPexeso.addEventListener("click", () => {
        renderPexeso();
        playTone(600, 0.2);
      });

      if (pickLesson) {
        pickLesson.addEventListener("click", () => playTone(540, 0.18));
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      renderWords();
      renderFlashcards(flashcards);
      renderGestures();
      renderPhrases();
      renderPexeso();
      bindControls();
    });
  </script>
</body>
</html>
